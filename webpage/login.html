<!DOCTYPE html>
<html lang="en">
<!--unfinshed CSS part
<head>
    <title>Course System Login</title>
    <style>
        .form-group
        {
            margin-bottom:14px;
        }
        .form-label
        {
            display:block;
            margin-bottom:6px;
        }
    </style>
</head>
-->
<body>
    <h1>Course System Login</h1>
    <p>Please select the role and put in the ID and password</p>
    <form id="login-form">
        <p>
            <input type="radio" name="role" value="student" checked>student
            <input type="radio" name="role" value="admin">admin
        </p>
        <p>
            <label for="user-id">ID:</label>
            <input type="text" id="user-id" name="user-id" placeholder="put in ID here">
        </p>
        <p>
            <label>password</label>
            <input type="text" id="password" name="password" placeholder="put in password here">
        </p>
        <p>
            <button type="button" id="Login">Login</button>
        </p>
        <p>
            <button type="button" id="toregister">To Register</button>
        </p>
    </form>
</body>
<script>
    document.getElementById("toregister").addEventListener("click",async(e)=>
    {
        e.preventDefault();
        window.location.href="register.html";
    });
    document.getElementById("Login").addEventListener("click",async(e)=>
    {
        e.preventDefault();
        const role=document.querySelector('input[name="role"]:checked').value;
        const id=document.getElementById("user-id").value.trim();
        const password=document.getElementById("password").value;

        try{
        const response=await fetch("http://localhost:8080/login",
            {
                method:"post",
                headers:{"Content-Type":"application/json"},
                body:JSON.stringify({
                    role:role,
                    id:id,
                    password:password
                })
            }
        )
        
        const result=await response.json();
        if(result.success)
        {
            alert("Login Successfully!");
            if(role=="student")
            {
                window.location.href="datacenter.html";
            }
            else
            {
                window.location.href="adminpanel.html";
            }
        }
        else
        {
            alert("Login Failed!");
        }
        }catch(err)
        {
            console.error(err);
            alert("Network Error!");
        }
    });
</script>
</html>